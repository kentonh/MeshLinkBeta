# Read each setting carefully and modify to your needs

### UPDATES
rev: 23 # increment after update!
ignore_update_prompt: False # set this to True if you do not want to answer y/n every time there is an update (set to True if using auto restart/startup)
check_for_updates: True # set to False to disable update checking

### DISCORD SETTINGS
use_discord: True
max_message_length: 200 # max discord -> mesh message length and info message length
info_channel_ids: [ 1234567890 ] # separate using commas
message_channel_ids: [ 1234567890 ]
secondary_channel_message_ids: [ ] # secondary channels to send and receive messages from. Each discord channel id in this list corresponds to a node's channel id 1-7.
token: "SDFjLKJVLREkjslRVJRLKjVLRKJLRVjrLKVJ" # discord bot token - DO NOT SHARE
discord_prefix: "$" # discord prefix
ignore_self: True # dont show your own node on discord
send_packets: True # show all data not just messages
ping_on_messages: True # should the bot add the message_role to the message
message_role: "@here" # the role on discord to ping on messages, if you dont want to ping everyone set to a custom role
permit_broadcast_of_discord_messages: True # allow messages from discord to be transmitted to your selected channel
send_mesh_commands_to_discord: True # send responses to mesh commands to discord

### MESH AND RADIO SETTINGS
prefix: "$" # mesh command prefix
use_serial: True # set to False if using tcp
radio_ip: "192.168.1.100" # ip of the radio if using tcp
send_channel_index: 0 # the index of the channel to send messages on
verbose_packets: False # should the full packet data be shown in the console
send_start_stop: True # should the meshlink announcement be sent on connection and shut down
include_username_prefix: True # include the username prefix in mesh messages from discord

### BUILT IN PLUGINS
weather_lat: "45.516022" # latitude for for weather plugin
weather_long: "-122.681427"
max_weather_hours: 8 # how many hours ahead to send weather info for

### SCHEDULED MESSAGES PLUGIN
# The scheduled messages plugin sends automated messages at configured intervals
# Configuration is in scheduled_messages.json (see scheduled_messages-example.json)
# No config.yml settings needed - all configuration is in the JSON file

### NODE TRACKING PLUGIN
# Tracks all nodes and packets received on the mesh network
# Stores data in SQLite database and exports to JSON for web visualization
node_tracking:
  enabled: true                           # Enable/disable node tracking
  max_packets_per_node: 1000             # Maximum packet history per node (older packets auto-deleted)
  database_path: "./nodes.db"            # Path to SQLite database file
  json_export_path: "./nodes.json"       # Path to JSON export file
  auto_export_json: true                 # Automatically export to JSON periodically
  
  # Web server configuration (for viewing node data in browser)
  web_server:
    enabled: false                        # Enable web server (requires Flask)
    host: "0.0.0.0"                      # Host to bind to (0.0.0.0 = all interfaces)
    port: 8080                           # Port for web interface
  
  # Packet types to track (leave empty to track all types)
  track_packet_types:
    - "TEXT_MESSAGE_APP"                 # Text messages
    - "POSITION_APP"                     # GPS location updates
    - "NODEINFO_APP"                     # Node information updates
    - "TELEMETRY_APP"                    # Battery, temperature, sensor data
    - "ROUTING_APP"                      # Routing information
  
  # Network topology tracking settings
  topology:
    enabled: true                         # Enable topology tracking (which nodes can hear each other)
    link_timeout_minutes: 60             # Mark links inactive after this many minutes without packets
    min_packets_for_link: 3              # Minimum packets required to establish valid link
    calculate_link_quality: true          # Calculate link quality scores based on SNR/RSSI
  
  # Automatic traceroute configuration
  auto_traceroute:
    enabled: false                        # Enable automatic traceroute sending
    interval_minutes: 30                  # How often to check and send traceroutes
    traceroute_age_hours: 4               # Send traceroute if last one older than this
    active_threshold_minutes: 60          # Node must be seen within this time to be "active"
    hop_limit: 7                          # Maximum hops for traceroute
    max_per_cycle: 5                      # Max traceroutes per check cycle
    delay_seconds: 10                     # Delay between sending each traceroute
    exclude_mqtt_nodes: true              # Don't traceroute MQTT-only nodes

  # Battery monitoring alerts (optional)
  battery_alerts:
    enabled: false                        # Enable battery alerts
    low_battery_threshold: 20            # Alert when battery drops below this percentage
    critical_battery_threshold: 10       # Critical battery alert threshold

### FEDERATED UPLOADER PLUGIN
# Uploads packet data and node database to MeshMonitor for centralized tracking
# Provides two upload strategies:
#   1. Real-time packet capture: Queues packets to outbox, uploaded by separate uploader service
#   2. Periodic database export: Background thread exports nodes.db data directly to MeshMonitor
federated_uploader:
  enabled: false                         # Set to true to enable uploading to MeshMonitor
  collector_id: "!ffffff"  # Unique node ID for this collector node
  api_url: "http://localhost:5000"       # MeshMonitor API URL (update to your server's address)
  token: ""                              # Not used for MeshMonitor (kept for compatibility)

  # Real-time packet capture (queued to outbox, uploaded by separate uploader service)
  outbox_db_path: "./federated_outbox.sqlite"  # Path to outbox database
  enqueue_packet_types:                  # Packet types to upload to central API
    - TEXT_MESSAGE_APP                   # Text messages (content NOT uploaded, only metadata)
    - POSITION_APP                       # GPS positions
    - NODEINFO_APP                       # Node information
    - TELEMETRY_APP                      # Battery, temperature, sensor data
    - TRACEROUTE_APP                     # Route discovery
    - ROUTING_APP                        # Routing information

  # Periodic database export (runs in background thread within MeshLinkBeta)
  export_enabled: true                   # Enable periodic export of nodes.db data
  export_interval_minutes: 60           # How often to export (in minutes)
  nodes_db_path: "./nodes.db"           # Path to nodes database
  export_hours_lookback: 2              # How many hours of data to export each time (overlapping to prevent gaps)
